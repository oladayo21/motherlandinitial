---
export interface Props {
  title?: string;
  subtitle?: string;
}

const {
  title = "Motherland",
  subtitle = "Berlin SC",
} = Astro.props;

// Slideshow content with featured news
const slides = [
  {
    image: "https://images.unsplash.com/photo-1631495634750-0f14320bc0a7?q=80&w=2071",
    title: "Promoted",
    subtitle: "To Landesliga FZ",
    description: "Historic achievement in our first year. From foundation to promotion â€“ the Motherland SC journey continues.",
    featuredNews: {
      category: "HISTORIC",
      title: "Promotion Secured to Landesliga FZ",
      excerpt: "Motherland SC achieves promotion to Landesliga FZ in June 2024, a remarkable milestone in our inaugural season.",
      image: "https://images.unsplash.com/photo-1522778119026-d647f0596c20?q=80&w=2070",
      time: "June 9, 2024",
      author: "Club News",
    },
  },
  {
    image: "https://images.unsplash.com/photo-1522778119026-d647f0596c20?q=80&w=2070",
    title: "African Heritage",
    subtitle: "Berlin Pride",
    description: "Celebrating African culture, values and heritage through the beautiful game in the heart of Berlin.",
    featuredNews: {
      category: "COMMUNITY",
      title: "Youth Programs Transform Lives",
      excerpt: "Motherland Youth Playday and Football & Tech initiatives provide opportunities for African youth aged 3-18 in Berlin.",
      image: "https://images.unsplash.com/photo-1606925797300-0b35e9d1794e?q=80&w=2071",
      time: "This Week",
      author: "Youth Department",
    },
  },
  {
    image: "https://images.unsplash.com/photo-1574629810360-7efbbe195018?q=80&w=2093",
    title: "Community",
    subtitle: "United",
    description: "A supportive atmosphere for all ages and skill levels. Together, we're building more than a club.",
    featuredNews: {
      category: "PARTNERSHIP",
      title: "Tony Ujah Foundation Partnership",
      excerpt: "Official sponsorship from Tony Ujah Foundation strengthens our mission to nurture African football talents in Germany.",
      image: "https://images.unsplash.com/photo-1560272564-c83b66b1ad12?q=80&w=2049",
      time: "Recent",
      author: "Partnership Team",
    },
  },
];
---

<section class="relative h-screen w-full overflow-hidden bg-black">
  <!-- Slideshow Background -->
  <div class="absolute inset-0 z-0">
    <!-- Slide Images -->
    {slides.map((slide, index) => (
      <div class={`slide absolute inset-0 transition-opacity duration-1000 ${index === 0 ? 'opacity-100' : 'opacity-0'}`} data-slide={index}>
        <div class="absolute inset-0 parallax-layer" data-speed="0.5">
          <img
            src={slide.image}
            alt={slide.title}
            class="w-full h-[120%] object-cover"
          />
        </div>
      </div>
    ))}
    
    <!-- Overlay gradients -->
    <div class="absolute inset-0 bg-gradient-to-b from-transparent via-black/40 to-black"></div>
    <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent"></div>
  </div>


  <!-- Main Content -->
  <div class="relative z-10 h-full flex items-center">
    <div class="w-full">
      <!-- Split Screen Layout -->
      <div class="grid lg:grid-cols-2 gap-8 md:gap-12 mx-auto max-w-[1920px] px-4 sm:px-6 md:px-8 lg:px-16">
        
        <!-- Left: Typography -->
        <div class="flex flex-col justify-center">
          <!-- Number/Year -->
          <div class="mb-4 md:mb-6 overflow-hidden">
            <div class="text-yellow/20 text-[80px] sm:text-[120px] md:text-[160px] lg:text-[200px] font-black leading-none -mb-8 sm:-mb-12 md:-mb-16 lg:-mb-20 animate-slide-in-left">
              2024
            </div>
          </div>
          
          <!-- Slide Content (Dynamic) -->
          {slides.map((slide, index) => (
            <div class={`slide-content ${index === 0 ? 'block' : 'hidden'}`} data-content={index}>
              <!-- Main Title -->
              <div class="space-y-2 mb-4 md:mb-8">
                <h1 class="font-display text-4xl sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-black text-white uppercase leading-none animate-slide-in-left animation-delay-200">
                  {slide.title}
                </h1>
                <h2 class="font-display text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-bold text-yellow uppercase animate-slide-in-left animation-delay-400">
                  {slide.subtitle}
                </h2>
              </div>
              
              <!-- Description -->
              <p class="text-base sm:text-lg md:text-xl text-white/70 max-w-lg mb-6 md:mb-8 animate-fade-in animation-delay-600">
                {slide.description}
              </p>
            </div>
          ))}
          
          <!-- Action Buttons -->
          <div class="flex flex-col sm:flex-row gap-3 sm:gap-4 animate-fade-in animation-delay-800">
            <a href="/tickets" class="bg-yellow px-6 sm:px-8 py-3 sm:py-4 font-bold text-sm sm:text-base text-black uppercase text-center hover:bg-yellow-400 transition-colors inline-block">
              Get Tickets
            </a>
            <a href="/news" class="border border-white/30 px-6 sm:px-8 py-3 sm:py-4 font-bold text-sm sm:text-base text-white uppercase hover:bg-white/10 transition-colors text-center">
              Latest News
            </a>
          </div>
        </div>
        
        <!-- Right: Featured News -->
        <div class="hidden lg:flex flex-col justify-center items-end">
          {slides.map((slide, index) => (
            <div class={`featured-news w-full max-w-md ${index === 0 ? 'block' : 'hidden'}`} data-news={index}>
              <!-- News Card with Glass Effect -->
              <div class="bg-white/5 backdrop-blur-lg border border-white/10 overflow-hidden animate-slide-in-right group hover:border-yellow/50 transition-all">
                <!-- News Image -->
                <div class="relative h-56 overflow-hidden">
                  <img
                    src={slide.featuredNews.image}
                    alt={slide.featuredNews.title}
                    class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"
                  />
                  <div class="absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent"></div>
                  
                  <!-- Category Badge -->
                  <div class="absolute top-4 left-4">
                    <span class="bg-yellow px-3 py-1 text-xs font-black text-black uppercase tracking-wider">
                      {slide.featuredNews.category}
                    </span>
                  </div>
                  
                  <!-- Time -->
                  <div class="absolute top-4 right-4">
                    <span class="bg-black/60 backdrop-blur-sm px-3 py-1 text-xs text-white/80">
                      {slide.featuredNews.time}
                    </span>
                  </div>
                </div>
                
                <!-- News Content -->
                <div class="p-8">
                  <!-- Title -->
                  <h3 class="font-display text-2xl font-black text-white mb-3 leading-tight group-hover:text-yellow transition-colors">
                    {slide.featuredNews.title}
                  </h3>
                  
                  <!-- Excerpt -->
                  <p class="text-white/70 mb-6 line-clamp-3">
                    {slide.featuredNews.excerpt}
                  </p>
                  
                  <!-- Author & CTA -->
                  <div class="flex items-center justify-between">
                    <div class="flex items-center gap-3">
                      <div class="w-8 h-8 bg-yellow/20 rounded-full flex items-center justify-center">
                        <span class="text-yellow text-xs font-bold">
                          {slide.featuredNews.author.split(' ').map(n => n[0]).join('')}
                        </span>
                      </div>
                      <span class="text-white/60 text-sm">
                        {slide.featuredNews.author}
                      </span>
                    </div>
                    
                    <a href="/article" class="flex items-center gap-2 text-yellow hover:gap-3 transition-all">
                      <span class="text-sm font-bold uppercase">Read</span>
                      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                      </svg>
                    </a>
                  </div>
                </div>
                
                <!-- Bottom Accent -->
                <div class="h-1 bg-gradient-to-r from-yellow via-yellow/50 to-transparent"></div>
              </div>
              
              <!-- Additional Quick News Links -->
              <div class="mt-4 space-y-2">
                <a href="/news" class="block bg-black/50 backdrop-blur-sm border border-white/10 p-3 hover:border-yellow/50 hover:bg-black/70 transition-all">
                  <div class="flex items-center justify-between">
                    <span class="text-white/80 text-sm">More breaking news</span>
                    <svg class="w-4 h-4 text-yellow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="square" stroke-linejoin="miter" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                  </div>
                </a>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  </div>
  
  <!-- Navigation Dots -->
  <div class="absolute bottom-24 sm:bottom-28 md:bottom-32 left-1/2 transform -translate-x-1/2 flex gap-2 z-20">
    {slides.map((_, index) => (
      <button 
        class={`slide-dot w-12 h-1 transition-colors ${index === 0 ? 'bg-yellow' : 'bg-white/20 hover:bg-white/40'}`}
        data-slide-index={index}
        aria-label={`Go to slide ${index + 1}`}
      ></button>
    ))}
  </div>
  
  <!-- Slide Progress Bar -->
  <div class="absolute bottom-20 sm:bottom-24 md:bottom-28 left-0 right-0 h-[1px] bg-white/10 z-20">
    <div class="slide-progress h-full bg-yellow transition-all duration-[5000ms] ease-linear" style="width: 0%"></div>
  </div>
</section>

<style>
  @keyframes slide-in-left {
    0% {
      transform: translateX(-100px);
      opacity: 0;
    }
    100% {
      transform: translateX(0);
      opacity: 1;
    }
  }
  
  @keyframes slide-in-right {
    0% {
      transform: translateX(100px);
      opacity: 0;
    }
    100% {
      transform: translateX(0);
      opacity: 1;
    }
  }
  
  @keyframes fade-in {
    0% {
      opacity: 0;
    }
    100% {
      opacity: 1;
    }
  }
  
  .animate-slide-in-left {
    animation: slide-in-left 1s ease-out both;
  }
  
  .animate-slide-in-right {
    animation: slide-in-right 1s ease-out both;
  }
  
  .animate-fade-in {
    animation: fade-in 1s ease-out both;
  }
  
  .animation-delay-200 {
    animation-delay: 0.2s;
  }
  
  .animation-delay-400 {
    animation-delay: 0.4s;
  }
  
  .animation-delay-600 {
    animation-delay: 0.6s;
  }
  
  .animation-delay-800 {
    animation-delay: 0.8s;
  }
  
  .animation-delay-1000 {
    animation-delay: 1s;
  }
</style>

<script>
  // Slideshow functionality
  function initSlideshow() {
    const slides = document.querySelectorAll('.slide');
    const contents = document.querySelectorAll('.slide-content');
    const featuredNews = document.querySelectorAll('.featured-news');
    const dots = document.querySelectorAll('.slide-dot');
    const progressBar = document.querySelector('.slide-progress');
    let currentSlide = 0;
    let slideInterval;
    const SLIDE_DURATION = 5000; // 5 seconds per slide

    function showSlide(index) {
      // Hide all slides and contents
      slides.forEach((slide, i) => {
        slide.classList.toggle('opacity-30', i === index);
        slide.classList.toggle('opacity-0', i !== index);
      });
      
      contents.forEach((content, i) => {
        content.classList.toggle('block', i === index);
        content.classList.toggle('hidden', i !== index);
        
        // Restart animations when showing
        if (i === index) {
          const animatedElements = content.querySelectorAll('[class*="animate-"]');
          animatedElements.forEach(el => {
            const classes = Array.from(el.classList);
            el.classList.remove(...classes.filter(c => c.startsWith('animate-')));
            void el.offsetWidth; // Trigger reflow
            el.classList.add(...classes.filter(c => c.startsWith('animate-')));
          });
        }
      });
      
      // Update featured news
      featuredNews.forEach((news, i) => {
        news.classList.toggle('block', i === index);
        news.classList.toggle('hidden', i !== index);
        
        // Restart animations for news card
        if (i === index) {
          const card = news.querySelector('.animate-slide-in-right');
          if (card) {
            card.classList.remove('animate-slide-in-right');
            void card.offsetWidth;
            card.classList.add('animate-slide-in-right');
          }
        }
      });
      
      // Update dots
      dots.forEach((dot, i) => {
        dot.classList.toggle('bg-yellow', i === index);
        dot.classList.toggle('bg-white/20', i !== index);
      });
      
      // Reset and start progress bar
      if (progressBar) {
        progressBar.style.transition = 'none';
        progressBar.style.width = '0%';
        void progressBar.offsetWidth; // Force reflow
        progressBar.style.transition = `width ${SLIDE_DURATION}ms linear`;
        progressBar.style.width = '100%';
      }
      
      currentSlide = index;
    }

    function nextSlide() {
      const next = (currentSlide + 1) % slides.length;
      showSlide(next);
    }

    function startSlideshow() {
      slideInterval = setInterval(nextSlide, SLIDE_DURATION);
    }

    function stopSlideshow() {
      clearInterval(slideInterval);
    }

    // Manual navigation
    dots.forEach((dot, index) => {
      dot.addEventListener('click', () => {
        stopSlideshow();
        showSlide(index);
        startSlideshow();
      });
    });

    // Pause on hover
    const section = document.querySelector('section');
    section.addEventListener('mouseenter', stopSlideshow);
    section.addEventListener('mouseleave', startSlideshow);

    // Start the slideshow
    showSlide(0);
    startSlideshow();
  }

  // Parallax effect
  function initParallax() {
    const layers = document.querySelectorAll('.parallax-layer');
    
    window.addEventListener('scroll', () => {
      const scrolled = window.pageYOffset;
      
      layers.forEach(layer => {
        const speed = layer.dataset.speed || 0.5;
        const yPos = -(scrolled * parseFloat(speed));
        layer.style.transform = `translateY(${yPos}px)`;
      });
    });
  }
  
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      initSlideshow();
      initParallax();
    });
  } else {
    initSlideshow();
    initParallax();
  }
</script>